(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,17521,69638,e=>{"use strict";e.s(["default",()=>s],17521);var r=e.i(75254);let s=(0,r.default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["CheckCircle",()=>t],69638);let t=(0,r.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},18566,(e,r,s)=>{r.exports=e.r(76562)},39179,e=>{"use strict";e.s(["StatusMessage",()=>l],39179);var r=e.i(43476),s=e.i(17521),s=s,t=e.i(69638),a=e.i(75254);let d=(0,a.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),i=(0,a.default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var n=e.i(67881);function l(e){let{status:a,message:l,countdown:o,onActionClick:c,actionLabel:u,className:m=""}=e;return(0,r.jsxs)("div",{className:"max-w-md mx-auto p-8 text-center border rounded-lg shadow-sm\n        ".concat("success"===a?"border-green-300 dark:border-green-700 bg-green-50 dark:bg-green-900":"error"===a?"border-red-300 dark:border-red-700 bg-red-50 dark:bg-red-900":"loading"===a?"border-blue-300 dark:border-blue-700 bg-blue-50 dark:bg-blue-900":"border-gray-300 dark:border-gray-700 bg-white dark:bg-zinc-900","\n        ").concat(m),children:[(()=>{let e={className:"w-10 h-10 mx-auto mb-3"};switch(a){case"loading":return(0,r.jsx)(s.default,{...e,className:"".concat(e.className," animate-spin text-blue-500")});case"success":return(0,r.jsx)(t.CheckCircle,{...e,className:"".concat(e.className," text-green-500")});case"error":return(0,r.jsx)(d,{...e,className:"".concat(e.className," text-red-500")});default:return(0,r.jsx)(i,{...e,className:"".concat(e.className," text-gray-500")})}})(),(0,r.jsx)("p",{className:"mb-2 font-medium ".concat((()=>{switch(a){case"loading":return"text-blue-600 dark:text-blue-400";case"success":return"text-green-600 dark:text-green-400";case"error":return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-300"}})()),children:l}),"number"==typeof o&&o>0&&(0,r.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Redirecting in ",o," second",1!==o?"s":"","..."]}),c&&u&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(n.Button,{variant:"outline",onClick:c,children:u})})]})}},65242,e=>{"use strict";e.s(["default",()=>u]);var r=e.i(43476),s=e.i(71645),t=e.i(18566),a=e.i(81949),d=e.i(53145),i=e.i(39179),n=e.i(67881),l=e.i(23750),o=e.i(74946);function c(){let e=(0,t.useRouter)(),c=(0,t.useSearchParams)(),u=c.get("email"),m=c.get("token"),[x,g]=(0,s.useState)("verifying"),[b,h]=(0,s.useState)("Verifying reset token..."),[p,f]=(0,s.useState)(5),[y,k]=(0,s.useState)(null),w=(0,d.useForm)({defaultValues:{password:"",confirmPassword:""}}),v="verifying"===x||"submitting"===x,j="invalid"===x||"error"===x,N="success"===x,F="submitting"===x;async function S(e){if(!u||!m){g("error"),h("Missing email or token.");return}g("submitting"),h("Updating your password..."),k(null);try{await a.default.post("/api/auth/reset-password",{email:u,token:m,password:e.password,action:"reset"}),g("success"),h("Password updated successfully! Redirecting to login...")}catch(t){var r,s;let e=(null==(s=t.response)||null==(r=s.data)?void 0:r.error)||"Failed to reset password.";e.toLowerCase().includes("password cannot be the same")?(k(e),g("valid")):(g("error"),h(e))}}return((0,s.useEffect)(()=>{if(!u||!m){g("invalid"),h("Invalid reset link.");return}!async function(){try{let e=await a.default.post("/api/auth/reset-password",{email:u,token:m,action:"verify"});e.data.valid?g("valid"):(g("invalid"),h(e.data.message||"Reset link is invalid or expired."))}catch(s){var e,r;g("invalid"),h((null==(r=s.response)||null==(e=r.data)?void 0:e.error)||"Failed to verify token.")}}()},[u,m]),(0,s.useEffect)(()=>{if("success"===x){if(p<=0)return void e.push("/signin");let r=setTimeout(()=>{f(e=>e-1)},1e3);return()=>clearTimeout(r)}},[x,p,e]),(0,s.useEffect)(()=>{let e=w.watch(()=>{y&&k(null)});return()=>e.unsubscribe()},[w,y]),v)?(0,r.jsx)(i.StatusMessage,{status:"loading",message:b}):j?(0,r.jsx)(i.StatusMessage,{status:"error",message:b,actionLabel:"Request New Reset Link",onActionClick:()=>e.push("/forgot-password")}):N?(0,r.jsx)(i.StatusMessage,{status:"success",message:b,countdown:p}):(0,r.jsxs)("div",{className:"max-w-lg mx-auto p-8 bg-white dark:bg-zinc-900 rounded-2xl shadow-xl",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-center mb-4",children:"Set New Password"}),(0,r.jsxs)("p",{className:"text-center text-gray-500 dark:text-gray-300 mb-6",children:["For: ",(0,r.jsx)("strong",{children:u})]}),y&&(0,r.jsx)("div",{className:"mb-6 text-center text-red-600 dark:text-red-400 font-semibold border border-red-400 dark:border-red-700 bg-red-100 dark:bg-red-900/30 px-4 py-3 rounded-md",children:y}),(0,r.jsx)(o.Form,{...w,children:(0,r.jsxs)("form",{onSubmit:w.handleSubmit(S),className:"space-y-6",children:[(0,r.jsx)(o.FormField,{control:w.control,name:"password",rules:{required:"Password is required",minLength:{value:6,message:"Minimum 6 characters"}},render:e=>{var s;let{field:t,fieldState:a}=e;return(0,r.jsxs)(o.FormItem,{children:[(0,r.jsx)(o.FormLabel,{children:"New Password"}),(0,r.jsx)(o.FormControl,{children:(0,r.jsx)(l.Input,{type:"password",...t,disabled:F})}),(0,r.jsx)(o.FormMessage,{children:null==(s=a.error)?void 0:s.message})]})}}),(0,r.jsx)(o.FormField,{control:w.control,name:"confirmPassword",rules:{required:"Please confirm your password",validate:e=>e===w.getValues("password")||"Passwords do not match"},render:e=>{var s;let{field:t,fieldState:a}=e;return(0,r.jsxs)(o.FormItem,{children:[(0,r.jsx)(o.FormLabel,{children:"Confirm Password"}),(0,r.jsx)(o.FormControl,{children:(0,r.jsx)(l.Input,{type:"password",...t,disabled:F})}),(0,r.jsx)(o.FormMessage,{children:null==(s=a.error)?void 0:s.message})]})}}),(0,r.jsx)(n.Button,{type:"submit",className:"w-full",disabled:F,children:F?"Updating...":"Update Password"})]})}),(0,r.jsx)("div",{className:"mt-6 text-center",children:(0,r.jsx)(n.Button,{variant:"link",onClick:()=>e.push("/signin"),className:"text-primary underline",disabled:F,children:"Back to Sign In"})})]})}function u(){return(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)("div",{className:"p-8 text-center text-gray-500",children:"Loading form..."}),children:(0,r.jsx)(c,{})})}}]);